---
title: "QMM 4"
author: "Neetu"
date: "2024-09-21"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Decision Variables
# Denote and define decision variables

# Function = X_ij where
# size (L, M, S) = _i
# plant (1, 2, 3) = _j

# Number of large units produced at each plant
X_L1 <- 0  # Large units at plant 1
X_M1 <- 0  # Medium units at plant 1
X_S1 <- 0  # Small units at plant 1

X_L2 <- 0  # Large units at plant 2
X_M2 <- 0  # Medium units at plant 2
X_S2 <- 0  # Small units at plant 2

X_L3 <- 0  # Large units at plant 3
X_M3 <- 0  # Medium units at plant 3
X_S3 <- 0  # Small units at plant 3

# Decision Variables
# Denote decision variables
# Function = X_ij where
# size (L, M, S) = _i
# plant (1, 2, 3) = _j

# Decision Variables
X_L1 <- 0  # Number of large units produced at plant 1
X_M1 <- 0  # Number of medium units produced at plant 1
X_S1 <- 0  # Number of small units produced at plant 1

X_L2 <- 0  # Number of large units produced at plant 2
X_M2 <- 0  # Number of medium units produced at plant 2
X_S2 <- 0  # Number of small units produced at plant 2

X_L3 <- 0  # Number of large units produced at plant 3
X_M3 <- 0  # Number of medium units produced at plant 3
X_S3 <- 0  # Number of small units produced at plant 3

# Objective Function
Z <- 420 * (X_L1 + X_L2 + X_L3) + 
     360 * (X_M1 + X_M2 + X_M3) + 
     300 * (X_S1 + X_S2 + X_S3)

# Constraints
# Capacity Constraints
capacity_constraints <- list(
  X_L1 + X_M1 + X_S1 <= 750,
  X_L2 + X_M2 + X_S2 <= 900,
  X_L3 + X_M3 + X_S3 <= 450
)

# Storage Constraints
storage_constraints <- list(
  20 * X_L1 + 15 * X_M1 + 12 * X_S1 <= 13000,
  20 * X_L2 + 15 * X_M2 + 12 * X_S2 <= 12000,
  20 * X_L3 + 15 * X_M3 + 12 * X_S3 <= 5000
)

# Sales Constraints
sales_constraints <- list(
  X_L1 + X_L2 + X_L3 <= 900,
  X_M1 + X_M2 + X_M3 <= 1200,
  X_S1 + X_S2 + X_S3 <= 750
)

# Equal Percentage of Capacity Utilization
utilization_constraints <- list(
  (X_L1 + X_M1 + X_S1) / 750 == (X_L2 + X_M2 + X_S2) / 900,
  (X_L1 + X_M1 + X_S1) / 750 == (X_L3 + X_M3 + X_S3) / 450
)

# Non-negativity Constraints
non_negativity_constraints <- list(
  X_L1 >= 0, X_M1 >= 0, X_S1 >= 0,
  X_L2 >= 0, X_M2 >= 0, X_S2 >= 0,
  X_L3 >= 0, X_M3 >= 0, X_S3 >= 0
)

# Solving using R
```{r}
# Load the lpSolve package
library(lpSolve)

# Define the objective function coefficients
objective_coefficients <- c(420, 360, 300, 420, 360, 300, 420, 360, 300)

# Set up the constraints matrix
constraints <- matrix(c(
  # Capacity Constraints
  1, 1, 1, 0, 0, 0, 0, 0, 0,  # Plant 1
  0, 0, 0, 1, 1, 1, 0, 0, 0,  # Plant 2
  0, 0, 0, 0, 0, 0, 1, 1, 1,  # Plant 3
  
  # Storage Constraints
  20, 15, 12, 0, 0, 0, 0, 0, 0,  # Plant 1 storage
  0, 0, 0, 20, 15, 12, 0, 0, 0,  # Plant 2 storage
  0, 0, 0, 0, 0, 0, 20, 15, 12,  # Plant 3 storage
  
  # Sales Constraints
  1, 0, 0, 1, 0, 0, 1, 0, 0,  # Large units
  0, 1, 0, 0, 1, 0, 0, 1, 0,  # Medium units
  0, 0, 1, 0, 0, 1, 0, 0, 1   # Small units
  
), nrow = 12, byrow = TRUE)

# Define the direction of the constraints
constraint_directions <- c("<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=", "<=")

# Right-hand side values for constraints
rhs_values <- c(
  750,   # Plant 1 capacity
  900,   # Plant 2 capacity
  450,   # Plant 3 capacity
  13000, # Plant 1 storage
  12000, # Plant 2 storage
  5000,  # Plant 3 storage
  900,   # Total large units
  1200,  # Total medium units
  750    # Total small units
)

# Solve the linear programming problem
solution <- lp("max", objective_coefficients, constraints, constraint_directions, rhs_values)

# Output the maximized profit
max_profit <- solution$objval
print(max_profit)

# Output the values of the decision variables
decision_vars <- solution$solution
print(decision_vars)
```


